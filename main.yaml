blocks:
  # Example 1: Simple loop over a list of strings
  # Creates multiple directories from a list defined in storage
  - for:
      individual: folder-name
      in: ${config.backup-folders}
      run: mkdir -p ./backups/${folder-name} && echo "Created ${folder-name}"

  # Example 2: Loop over list of dictionaries
  # Process each server configuration sequentially
  - for:
      individual: server
      in: ${servers.web-servers}
      run: 'echo "Server: ${server.name} at ${server.ip}:${server.port}"'

  # Example 3: Parallel loop execution
  # Download files from multiple URLs simultaneously
  - parallel:
      for:
        individual: dataset
        in: ${datasets.sources}
        run: wget -O ./backups/data/${dataset.filename} ${dataset.url}

  # Example 4: Remote execution with loops
  # Run health checks on all servers in parallel
  # Stream logs in real-time with: tail -f ./backups/logs/*_health.log
  - parallel:
      for:
        individual: server
        in: ${servers.production-servers}
        run-remotely:
          ip: ${server.ip}
          user: ${server.username}
          pass: ${server.password}
          run: uptime && df -h && free -m
          log-into: ./backups/logs/${server.name}_health.log

  # Example 5: Nested loops
  # Create complex directory structures
  - for:
      individual: project
      in: ${structure.projects}
      run: mkdir -p ${project.name}
      for:
        individual: subdir
        in: ${project.subdirectories}
        run: mkdir -p ${project.name}/${subdir.name} && echo "Setup ${project.name}/${subdir.name}"

  # Example 6: Loop with conditional logic
  # Process only specific file types
  - for:
      individual: file-type
      in: ${config.file-types}
      run: |
        if [ "${file-type}" = "logs" ]; then
          echo "Processing log files..."
          ls -la ./backups/${file-type}/*.log 2>/dev/null || echo "No log files found"
        else
          echo "Skipping ${file-type}"
        fi

  # Summary
  - run: |
      echo "=== Loop Execution Summary ==="
      echo "Directories created:"
      ls -la ./backups/
      echo "Logs collected:"
      ls -la ./backups/logs/ 2>/dev/null || echo "No logs collected"
